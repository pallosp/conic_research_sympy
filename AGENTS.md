# Agent instructions

A symbolic 2D projective and Euclidean geometry toolkit built on **SymPy**.

## üõ† Tech stack

- **Language**: Python 3.12+ (uses type unions, `@override`)
- **Core Lib**: `sympy`
- **Tooling**: `poetry`, `pre-commit`, `ruff` (strict: `ALL` rules), `pytest`,
  `pydoc-markdown`

## üìÇ Project structure

- `src/lib/`: Core library modules.
  - `point.py`, `line.py`, `conic.py`, `polar_conic.py`: Fundamental geometric
    entities.
  - `matrix.py`: SymPy matrix utility helpers.
  - `transform.py`: Projective transformations.
  - `incidence.py`, `intersection.py`, `distance.py`: Geometric relations.
- `src/research/`: Research scripts containing derivations and proofs for
  implemented formulas.
- `tests/`: Comprehensive test suite mirroring `src/lib` structure.
- `docs/`: API documentation generated by `pydoc-markdown`.

## üìê Key conventions

- **Homogeneous coordinates**: Points and lines are $3 \times 1$ `Matrix`.
  Conics are $3 \times 3$ symmetric `Matrix`.
- **Projective equality**: Entities are equal if they are non-zero multiples.
  Use `is_nonzero_multiple(a, b)` from `lib.matrix` instead of `==`.
- **Functional API**: Logic is primarily function-based; classes are used only
  for custom SymPy functions.
- **Docstrings**: Include mathematical background, Wikipedia links, and
  references to `src/research/` derivations.
- **Fuzzy logic**: Use 3-valued logic (`True`, `False`, `None`) for boolean
  checks, where `None` indicates undecidable. Use the `sympy.core.logic.fuzzy_*`
  helpers when needed.

## üöÄ Common commands

- **Lint/Format**: `ruff check --fix`
- **Test**: `pytest`
- **Coverage**: `pytest --cov src/lib --cov-report html`
- **Docs**: `pydoc-markdown`
- **Pre-commit**: `pre-commit run --all-files`

## ü§ñ Agent instructions

- **Command execution**: Run read-only commands (e.g., `ls`, `git status`,
  `find`) with `SafeToAutoRun: true` to explore the project efficiently.
- **Quality**: Run linter and tests before finishing.
- **Documentation**: Regenerate API docs using `pydoc-markdown` after each
  public API change.
- **Lint checks**: Prefer fixing the code or reporting warnings over adding
  `# noqa` comments.
